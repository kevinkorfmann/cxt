Search.setIndex({"alltitles": {"Constant Demography Pairwise Inference": [[1, "constant-demography-pairwise-inference"]], "Contents:": [[2, null]], "Demonstrations": [[1, null]], "Indices and tables": [[2, "indices-and-tables"]], "Module contents": [[0, "module-cxt"]], "Modules/API": [[3, null]], "Simulations/API": [[4, null]], "Utils/API": [[5, null]], "Welcome to cxt\u2019s documentation!": [[2, null]], "cxt package": [[0, null]], "cxt.modules": [[3, "module-cxt.modules"]], "cxt.simulation": [[4, "module-cxt.simulation"]], "cxt.utils": [[5, "module-cxt.utils"]]}, "docnames": ["cxt", "demo", "index", "modules", "simulations", "utils"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["cxt.rst", "demo.rst", "index.rst", "modules.rst", "simulations.rst", "utils.rst"], "indexentries": {"bias (cxt.modules.layernorm attribute)": [[3, "cxt.modules.LayerNorm.bias", false]], "block (class in cxt.modules)": [[3, "cxt.modules.Block", false]], "c_fc (cxt.modules.mlp attribute)": [[3, "cxt.modules.MLP.c_fc", false]], "c_proj (cxt.modules.mlp attribute)": [[3, "cxt.modules.MLP.c_proj", false]], "calculate_window_sfs_vectorized() (in module cxt.utils)": [[5, "cxt.utils.calculate_window_sfs_vectorized", false]], "causalselfattention (class in cxt.modules)": [[3, "cxt.modules.CausalSelfAttention", false]], "clear() (cxt.modules.mutationstolatentspace method)": [[3, "cxt.modules.MutationsToLatentSpace.clear", false]], "create_sawtooth_demogaphy_object() (in module cxt.simulation)": [[4, "cxt.simulation.create_sawtooth_demogaphy_object", false]], "create_sawtooth_demogaphy_object() (in module cxt.utils)": [[5, "cxt.utils.create_sawtooth_demogaphy_object", false]], "cxt.modules": [[3, "module-cxt.modules", false]], "cxt.simulation": [[4, "module-cxt.simulation", false]], "cxt.utils": [[5, "module-cxt.utils", false]], "decreasing_mses() (in module cxt.utils)": [[5, "cxt.utils.decreasing_mses", false]], "discretize() (in module cxt.utils)": [[5, "cxt.utils.discretize", false]], "dropout (cxt.modules.mlp attribute)": [[3, "cxt.modules.MLP.dropout", false]], "forward() (cxt.modules.block method)": [[3, "cxt.modules.Block.forward", false]], "forward() (cxt.modules.causalselfattention method)": [[3, "cxt.modules.CausalSelfAttention.forward", false]], "forward() (cxt.modules.layernorm method)": [[3, "cxt.modules.LayerNorm.forward", false], [3, "id0", false]], "forward() (cxt.modules.mlp method)": [[3, "cxt.modules.MLP.forward", false], [3, "id1", false]], "forward() (cxt.modules.mutationstolatentspace method)": [[3, "cxt.modules.MutationsToLatentSpace.forward", false]], "gelu (cxt.modules.mlp attribute)": [[3, "cxt.modules.MLP.gelu", false]], "generate_causal_mask() (in module cxt.utils)": [[5, "cxt.utils.generate_causal_mask", false]], "generate_data() (in module cxt.simulation)": [[4, "cxt.simulation.generate_data", false]], "get_kv() (cxt.modules.mutationstolatentspace method)": [[3, "cxt.modules.MutationsToLatentSpace.get_kv", false]], "interpolate_tmrca_per_window() (in module cxt.utils)": [[5, "cxt.utils.interpolate_tmrca_per_window", false]], "interpolate_tmrcas() (in module cxt.utils)": [[5, "cxt.utils.interpolate_tmrcas", false]], "layernorm (class in cxt.modules)": [[3, "cxt.modules.LayerNorm", false]], "mlp (class in cxt.modules)": [[3, "cxt.modules.MLP", false]], "module": [[3, "module-cxt.modules", false], [4, "module-cxt.simulation", false], [5, "module-cxt.utils", false]], "mse() (in module cxt.utils)": [[5, "cxt.utils.mse", false]], "mutationstolatentspace (class in cxt.modules)": [[3, "cxt.modules.MutationsToLatentSpace", false]], "population_time() (in module cxt.utils)": [[5, "cxt.utils.population_time", false]], "post_process() (in module cxt.utils)": [[5, "cxt.utils.post_process", false]], "process_batches() (in module cxt.simulation)": [[4, "cxt.simulation.process_batches", false]], "process_pair() (in module cxt.utils)": [[5, "cxt.utils.process_pair", false]], "retrieve_site_positions() (in module cxt.utils)": [[5, "cxt.utils.retrieve_site_positions", false]], "save_batch() (in module cxt.simulation)": [[4, "cxt.simulation.save_batch", false]], "simulate_parameterized_tree_sequence() (in module cxt.utils)": [[5, "cxt.utils.simulate_parameterized_tree_sequence", false]], "src_key_cache (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.src_key_cache", false]], "src_len (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.src_len", false]], "src_value_cache (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.src_value_cache", false]], "tgt_key_cache (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.tgt_key_cache", false]], "tgt_len (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.tgt_len", false]], "tgt_value_cache (cxt.modules.mutationstolatentspace attribute)": [[3, "cxt.modules.MutationsToLatentSpace.tgt_value_cache", false]], "ts2input() (in module cxt.utils)": [[5, "cxt.utils.ts2input", false]], "ts2input_numpy() (in module cxt.utils)": [[5, "cxt.utils.ts2input_numpy", false]], "ts2x_vectorized() (in module cxt.utils)": [[5, "cxt.utils.ts2X_vectorized", false]], "update_source() (cxt.modules.mutationstolatentspace method)": [[3, "cxt.modules.MutationsToLatentSpace.update_source", false]], "update_target() (cxt.modules.mutationstolatentspace method)": [[3, "cxt.modules.MutationsToLatentSpace.update_target", false]], "weight (cxt.modules.layernorm attribute)": [[3, "cxt.modules.LayerNorm.weight", false]], "xnor() (in module cxt.utils)": [[5, "cxt.utils.xnor", false]], "xor() (in module cxt.utils)": [[5, "cxt.utils.xor", false]]}, "objects": {"": [[0, 0, 0, "-", "cxt"]], "cxt": [[3, 0, 0, "-", "modules"], [4, 0, 0, "-", "simulation"], [5, 0, 0, "-", "utils"]], "cxt.modules": [[3, 1, 1, "", "Block"], [3, 1, 1, "", "CausalSelfAttention"], [3, 1, 1, "", "LayerNorm"], [3, 1, 1, "", "MLP"], [3, 1, 1, "", "MutationsToLatentSpace"]], "cxt.modules.Block": [[3, 2, 1, "", "forward"]], "cxt.modules.CausalSelfAttention": [[3, 2, 1, "", "forward"]], "cxt.modules.LayerNorm": [[3, 3, 1, "", "bias"], [3, 2, 1, "id0", "forward"], [3, 3, 1, "", "weight"]], "cxt.modules.MLP": [[3, 3, 1, "", "c_fc"], [3, 3, 1, "", "c_proj"], [3, 3, 1, "", "dropout"], [3, 2, 1, "id1", "forward"], [3, 3, 1, "", "gelu"]], "cxt.modules.MutationsToLatentSpace": [[3, 2, 1, "", "clear"], [3, 2, 1, "", "forward"], [3, 2, 1, "", "get_kv"], [3, 3, 1, "", "src_key_cache"], [3, 3, 1, "", "src_len"], [3, 3, 1, "", "src_value_cache"], [3, 3, 1, "", "tgt_key_cache"], [3, 3, 1, "", "tgt_len"], [3, 3, 1, "", "tgt_value_cache"], [3, 2, 1, "", "update_source"], [3, 2, 1, "", "update_target"]], "cxt.simulation": [[4, 4, 1, "", "create_sawtooth_demogaphy_object"], [4, 4, 1, "", "generate_data"], [4, 4, 1, "", "process_batches"], [4, 4, 1, "", "save_batch"]], "cxt.utils": [[5, 4, 1, "", "calculate_window_sfs_vectorized"], [5, 4, 1, "", "create_sawtooth_demogaphy_object"], [5, 4, 1, "", "decreasing_mses"], [5, 4, 1, "", "discretize"], [5, 4, 1, "", "generate_causal_mask"], [5, 4, 1, "", "interpolate_tmrca_per_window"], [5, 4, 1, "", "interpolate_tmrcas"], [5, 4, 1, "", "mse"], [5, 4, 1, "", "population_time"], [5, 4, 1, "", "post_process"], [5, 4, 1, "", "process_pair"], [5, 4, 1, "", "retrieve_site_positions"], [5, 4, 1, "", "simulate_parameterized_tree_sequence"], [5, 4, 1, "", "ts2X_vectorized"], [5, 4, 1, "", "ts2input"], [5, 4, 1, "", "ts2input_numpy"], [5, 4, 1, "", "xnor"], [5, 4, 1, "", "xor"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "terms": {"0": [1, 3, 4, 5], "001": 1, "06": 5, "08": 5, "1": [1, 3, 4, 5], "1000000": 5, "1001": 1, "102000": 1, "1225": 1, "16160": 1, "1e6": 1, "2": [1, 5], "20": 1, "200": 5, "2000": 5, "20000": [4, 5], "25": 5, "256": 1, "28e": 5, "29e": 5, "3": [], "4": [1, 4, 5], "40": 5, "400": 1, "4000": 5, "50": 1, "500000": 5, "510000": 5, "6": 1, "8": [], "A": [1, 3], "If": 3, "In": 1, "The": [1, 3, 4], "ab": 1, "activ": 3, "actual": 1, "add": 3, "after": 3, "afterward": 3, "all": 3, "alloc": 3, "although": 3, "api": 2, "append": 1, "appli": 3, "approach": 2, "arg": 5, "arrai": 5, "attent": 3, "attn": 1, "attn_mask": 3, "attribut": 3, "autoregress": [], "averag": 5, "avoid": 1, "b": [1, 3, 5], "back": 3, "base": [1, 3], "batch": [3, 4], "batch_siz": [1, 4], "becaus": 1, "becom": 1, "been": 1, "bia": [1, 3], "block": 3, "bool": [1, 3], "break": 1, "c_fc": 3, "c_proj": 3, "cach": [1, 3], "cache_k": 1, "cache_v": 1, "calcul": 5, "calculate_window_sfs_vector": 5, "call": 3, "callabl": 4, "care": 3, "case": 1, "causalselfattent": 3, "checkpoint": 1, "ckpt": 1, "class": [1, 3], "clear": 3, "coalesc": 2, "code": 1, "combined_dim": 1, "comput": 3, "concaten": 3, "config": [1, 3], "configur": [1, 3], "constant": 2, "contain": 3, "convers": 5, "cpu": 3, "create_sawtooth_demogaphy_object": [4, 5], "criteria": 1, "cuda": [1, 3], "cxt": 1, "data": [1, 4], "decod": 3, "decreasing_ms": [1, 5], "default": 4, "defin": 3, "demo": [], "demographi": [2, 5], "demonstr": 2, "deriv": 1, "devic": [1, 3, 5], "diff": 1, "dimens": 3, "directori": 4, "discret": 5, "dropout": [1, 3], "dure": [1, 3], "e": 3, "each": [1, 3], "earli": 1, "effici": 5, "embed": 3, "epoch": 1, "estim": 5, "everi": 3, "exampl": 1, "f": 1, "fals": [1, 3], "featur": 5, "few": 1, "first": [3, 4], "float": [1, 3, 5], "float32": 1, "follow": [1, 3], "former": 3, "forward": 3, "fragment": 1, "from": 1, "full_k": [], "full_v": [], "function": [1, 3, 4, 5], "g": 3, "gelu": 3, "gener": [1, 4], "generate_causal_mask": 5, "generate_data": 4, "genet": 2, "get_kv": 3, "given": [3, 5], "h": 1, "ha": 1, "head": 3, "head_siz": 3, "heurist": 1, "higher": 3, "hook": 3, "how": 1, "i": [1, 3, 4], "idx": 4, "ignor": 3, "implement": 1, "import": 1, "increment": 3, "index": [2, 4], "infer": 2, "input": 3, "instanc": 3, "instead": 3, "int": [1, 3, 4, 5], "interpol": 5, "interpolate_tmrca": 5, "interpolate_tmrca_per_window": 5, "interv": 5, "interval_end": 5, "interval_s": 5, "interval_start": 5, "j": 1, "kei": 3, "kv_cach": [], "kvcach": [], "lambda": [1, 5], "languag": 2, "latter": 3, "layer": 3, "layernorm": 3, "learnabl": 3, "length": 3, "less": 1, "light": 1, "lightning_log": 1, "linear": 3, "list": 5, "load": 1, "load_model": 1, "magnitu": [4, 5], "matrix": 5, "max_batch_s": 3, "max_repl": 1, "max_seq_length": 3, "maximum": 3, "mb": 1, "mean": 1, "medium": 1, "memori": 5, "mlp": 3, "model": [1, 2], "model_path": 1, "modul": 2, "mse": [1, 5], "multi": 3, "multiprocess": 4, "mutation_r": 5, "mutationstolatentspac": 3, "n_embd": [1, 3], "n_head": [1, 3], "n_layer": 1, "ndarrai": 5, "ndim": 3, "ne": [4, 5], "need": 3, "nn": 3, "none": [3, 4, 5], "normal": 3, "note": 1, "np": 1, "num_lay": 1, "num_point": 5, "num_process": 4, "num_sampl": [1, 4, 5], "num_time_window": 5, "number": [3, 4], "numpi": 1, "object": 3, "one": 3, "option": 4, "order": 1, "origin": 3, "otherwis": 3, "output": [3, 4], "output_dim": 1, "output_dir": 4, "over": 1, "overal": 1, "overridden": 3, "overwrit": 3, "packag": 1, "page": 2, "pairwis": 2, "param": 3, "paramet": [3, 4], "pass": 3, "per": 4, "perceptron": 3, "perform": 3, "pivot": 4, "pivot_a": [4, 5], "pivot_b": [4, 5], "pivot_frequ": 5, "ploidi": 5, "plot": 1, "popul": 2, "population_s": 5, "population_tim": 5, "posit": [3, 5], "post_process": [1, 5], "pre": 3, "prepare_ts_data": 1, "print": 1, "probabl": 3, "process": [1, 4], "process_batch": 4, "process_pair": 5, "project": 3, "propos": 2, "python": [], "pytorch": 1, "randn": [], "rang": 1, "read": 3, "recip": 3, "recombination_r": 5, "regist": 3, "regular": 3, "replic": 1, "reset": [1, 3], "result": 4, "retrieve_site_posit": 5, "return": [3, 4], "run": [1, 3], "s_len": 3, "sampl": [1, 4, 5], "sample_scale_embd": 1, "save": 4, "save_batch": 4, "scale": 3, "search": 2, "second": [3, 4], "seed": [1, 5], "seq_len": 5, "sequenc": [1, 2, 3, 4, 5], "sequence_length": [1, 5], "set": 3, "set_float32_matmul_precis": 1, "sf": 5, "shape": 3, "should": 3, "shown": 1, "silent": 3, "simpl": 1, "simul": [1, 2], "simulate_parameterized_tree_sequ": [1, 5], "sinc": 3, "site_posit": 5, "size": [1, 3], "sourc": [3, 4, 5], "specif": 3, "specifi": 3, "src": 1, "src_k": [], "src_key_cach": 3, "src_len": 3, "src_v": [], "src_value_cach": 3, "stand": 2, "start": 4, "start_batch": 4, "step": 1, "step_siz": 5, "stop": 1, "store": 3, "str": [1, 3, 4], "subclass": 3, "t": [1, 3, 5], "take": 3, "target": 3, "tensor": 3, "tgt": [1, 5], "tgt_k": [], "tgt_key_cach": 3, "tgt_len": 3, "tgt_v": [], "tgt_value_cach": 3, "than": 1, "them": 3, "therebi": 2, "thi": 3, "time": [1, 5], "time_r": 5, "tmax": 5, "tmrca": [1, 5], "token": 3, "tokenfreedecoderconfig": 1, "torch": [1, 3], "total": 4, "track": [], "train": 1, "transform": 1, "translat": 2, "tree": [4, 5], "treesequ": 5, "true": 3, "ts2input": 5, "ts2input_numpi": 5, "ts2x_vector": 5, "ts_simulation_func": 4, "type": [3, 4], "unnessari": 1, "up": 3, "update_sourc": 3, "update_target": 3, "us": [1, 3, 4], "usag": 1, "use_bia": 3, "use_cach": 3, "util": [1, 2], "valid": 3, "valu": [3, 5], "vector": 5, "version_8": 1, "wa": 1, "weight": 3, "when": 1, "where": [3, 4], "whether": 3, "which": 3, "while": 3, "window_s": 5, "within": 3, "write": 3, "x": [2, 3], "xnor": 5, "xor": 5, "xor_op": 5, "yhat": [1, 5], "ytrue": [1, 5], "zero": [1, 3]}, "titles": ["cxt package", "Demonstrations", "Welcome to cxt\u2019s documentation!", "Modules/API", "Simulations/API", "Utils/API"], "titleterms": {"": 2, "api": [3, 4, 5], "constant": 1, "content": [0, 2], "cxt": [0, 2, 3, 4, 5], "demo": [], "demographi": 1, "demonstr": 1, "document": 2, "indic": 2, "infer": 1, "kv_cach": [], "modul": [0, 3], "packag": 0, "pairwis": 1, "simul": 4, "tabl": 2, "util": 5, "welcom": 2}})