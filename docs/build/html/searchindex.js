Search.setIndex({"alltitles": {"API documentation": [[0, null]], "Comparisons with other tools": [[1, null]], "Constant Demography (Pairwise) Inference": [[9, "constant-demography-pairwise-inference"]], "Contents:": [[4, null]], "Gallery": [[3, null]], "Gamma-SMC": [[1, "gamma-smc"]], "Indices and tables": [[4, "indices-and-tables"]], "Installation": [[5, null]], "Module contents": [[2, "module-cxt"]], "Out-of-sample: Island Demography Inference (no fine-tuning)": [[9, "out-of-sample-island-demography-inference-no-fine-tuning"]], "Out-of-sample: Sawooth Demography Inference (no fine-tuning)": [[9, "out-of-sample-sawooth-demography-inference-no-fine-tuning"]], "Quick start": [[6, null]], "Rescue: Island Demography Inference (with fine-tuning)": [[9, "rescue-island-demography-inference-with-fine-tuning"]], "Rescue: Sawooth Demography Inference (with fine-tuning)": [[9, "rescue-sawooth-demography-inference-with-fine-tuning"]], "Simulation": [[7, null]], "Singer": [[1, "singer"]], "Singer and Gamma-SMC": [[3, "singer-and-gamma-smc"]], "Training": [[8, null]], "Tutorial for Inference": [[9, null]], "cxt package": [[2, null]], "cxt(kit)": [[3, "cxt-kit"]], "cxt(kit): Coalescence x Translation (toolkit)": [[4, null]], "cxt.model": [[0, "module-cxt.model"]], "cxt.modules": [[0, "module-cxt.modules"]], "cxt.simulations": [[0, "module-cxt.simulation"]], "cxt.utils": [[0, "module-cxt.utils"]]}, "docnames": ["api", "comparison", "cxt", "gallery", "index", "installation", "quick_start", "simulation", "training", "tutorial"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["api.rst", "comparison.rst", "cxt.rst", "gallery.rst", "index.rst", "installation.rst", "quick_start.rst", "simulation.rst", "training.rst", "tutorial.rst"], "indexentries": {}, "objects": {"": [[2, 0, 0, "-", "cxt"]], "cxt": [[0, 0, 0, "-", "model"], [0, 0, 0, "-", "modules"], [0, 0, 0, "-", "simulation"], [0, 0, 0, "-", "utils"]], "cxt.model": [[0, 1, 1, "", "TokenFreeDecoder"]], "cxt.model.TokenFreeDecoder": [[0, 2, 1, "", "clear_cache"], [0, 2, 1, "", "configure_optimizers"], [0, 2, 1, "", "forward"]], "cxt.modules": [[0, 1, 1, "", "Block"], [0, 1, 1, "", "CausalSelfAttention"], [0, 1, 1, "", "LayerNorm"], [0, 1, 1, "", "MLP"], [0, 1, 1, "", "MutationsToLatentSpace"]], "cxt.modules.Block": [[0, 2, 1, "", "forward"]], "cxt.modules.CausalSelfAttention": [[0, 2, 1, "", "forward"]], "cxt.modules.LayerNorm": [[0, 3, 1, "", "bias"], [0, 2, 1, "", "forward"], [0, 3, 1, "", "weight"]], "cxt.modules.MLP": [[0, 3, 1, "", "c_fc"], [0, 3, 1, "", "c_proj"], [0, 3, 1, "", "dropout"], [0, 2, 1, "", "forward"], [0, 3, 1, "", "gelu"]], "cxt.modules.MutationsToLatentSpace": [[0, 2, 1, "", "forward"]], "cxt.simulation": [[0, 4, 1, "", "create_sawtooth_demogaphy_object"], [0, 4, 1, "", "generate_data"], [0, 4, 1, "", "process_batches"], [0, 4, 1, "", "save_batch"]], "cxt.utils": [[0, 4, 1, "", "accumulating_mses"], [0, 4, 1, "", "calculate_window_sfs_vectorized"], [0, 4, 1, "", "create_sawtooth_demogaphy_object"], [0, 4, 1, "", "discretize"], [0, 4, 1, "", "generate_causal_mask"], [0, 4, 1, "", "interpolate_tmrca_per_window"], [0, 4, 1, "", "interpolate_tmrcas"], [0, 4, 1, "", "mse"], [0, 4, 1, "", "population_time"], [0, 4, 1, "", "post_process"], [0, 4, 1, "", "process_pair"], [0, 4, 1, "", "retrieve_site_positions"], [0, 4, 1, "", "simulate_parameterized_tree_sequence"], [0, 4, 1, "", "ts2X_vectorized"], [0, 4, 1, "", "ts2input"], [0, 4, 1, "", "ts2input_numpy"], [0, 4, 1, "", "xnor"], [0, 4, 1, "", "xor"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "terms": {"": 1, "0": [0, 1, 7, 8, 9], "000": [], "001": 9, "06": 0, "08": 0, "1": [0, 1, 7, 8, 9], "100": 1, "1000": 7, "10000": 1, "1000000": [0, 1], "1001": [], "102000": [6, 9], "103370001": [1, 9], "1225": 9, "13": 9, "14": 9, "15": 1, "16": 9, "16160": [6, 8, 9], "1_000_000": 9, "1d": 0, "1e6": [], "2": [0, 1, 8], "20": [1, 8, 9], "200": 0, "2000": [0, 1, 9], "20000": [0, 1], "200_000": 7, "2023": 1, "2024": 1, "20_000": 1, "20e3": 1, "25": [0, 1, 9], "256": [], "28e": 0, "29e": [0, 1], "2_000_000": 7, "3": 1, "30": 7, "300": 9, "3d": 0, "3e": 8, "4": [0, 6, 8, 9], "40": 0, "400": [], "4000": 0, "5": [1, 8], "50": [1, 9], "5000": 1, "500000": 0, "510000": 0, "6": [], "8": 1, "99": 1, "A": [0, 9], "And": 1, "For": 1, "If": 0, "In": 9, "Or": 8, "The": [0, 1, 7, 8, 9], "To": 8, "_": 1, "_fast": 1, "_island": 1, "_sawtooth": 1, "ab": 9, "abl": 9, "acces": 1, "accumulating_ms": [0, 9], "accuraci": 9, "accuratli": 9, "activ": 0, "actual": 9, "add": 0, "add_argu": [], "after": [], "afterward": 0, "against": 1, "al": 1, "all": 0, "alloc": [], "alpha": [1, 9], "although": 0, "an": 1, "api": 4, "append": [1, 9], "appli": [], "approach": 4, "ar": 1, "arg": 0, "argpars": [], "argumentpars": [], "arrai": [0, 1], "as_vcf": 1, "attent": [], "attn": [], "attn_mask": 0, "attribut": 0, "autoregress": [], "avail": 5, "averag": 0, "avoid": 9, "b": [0, 1, 9], "back": 0, "base": [0, 9], "base_model": [6, 8, 9], "basic": 1, "batch": 0, "batch_siz": [0, 7], "becaus": 9, "becom": 9, "been": 9, "being": 9, "below": 1, "beta": [0, 1], "better": 9, "between": [1, 9], "bia": 0, "black": 9, "block": 0, "blue": 9, "bool": 0, "bottleneck": 9, "bp": 9, "break": 9, "c": 9, "c_fc": 0, "c_proj": 0, "cach": 9, "cache_k": [], "cache_v": [], "calcul": 0, "calculate_loss": 0, "calculate_window_sfs_vector": 0, "call": 0, "callabl": 0, "can": [1, 5], "captur": 9, "care": 0, "case": 9, "causalselfattent": 0, "cdd": 7, "chang": [1, 9], "check": 1, "checkpoint": [6, 8, 9], "checkpoint_path": 8, "choic": [], "ckpt": [6, 8, 9], "class": 0, "clear": [], "clear_cach": 0, "clone": 5, "coalesc": 9, "code": [6, 7, 8, 9], "collaps": [], "com": [1, 5], "comb": 1, "combin": 1, "combined_dim": [], "command": [1, 8], "comparison": [4, 9], "complex": 9, "comput": 0, "concaten": [], "config": [0, 6, 9], "configur": [0, 9], "configure_optim": 0, "consequ": 9, "constant": [1, 4, 7], "contain": 0, "continu": 9, "convers": 0, "convert_to_tskit": 1, "cpu": [], "cpu_count": 1, "create_sawtooth_demogaphy_object": [0, 1], "criteria": 9, "cuda": [], "cxt": [1, 5, 6, 7, 8, 9], "data": [0, 1, 7, 9], "data_dir": 7, "dataset": [7, 8, 9], "dataset_path": 8, "decod": [], "decreas": 9, "decreasing_ms": [], "def": 1, "default": 0, "defin": 0, "degre": 9, "demo": [], "demograph": 1, "demographi": [0, 1, 4, 7, 8], "demonstr": [7, 8, 9], "deng": 1, "deriv": 9, "describ": [], "descript": [], "despit": 9, "develop": 1, "devic": 0, "device_typ": 0, "diff": 9, "differ": 1, "dimens": 0, "directori": 0, "discret": 0, "distribut": 9, "do": 1, "docker": 1, "document": 4, "done": 1, "dpi": 9, "dropout": 0, "due": 9, "durbin": 1, "dure": 9, "e": [], "each": 9, "earli": 9, "easier": 9, "effici": 0, "embed": 0, "emploi": 1, "end": 1, "entropi": 9, "epoch": [6, 8, 9], "estim": 0, "et": 1, "eventu": 5, "everi": 0, "exampl": [1, 9], "expans": 9, "extract": 1, "f": [1, 9], "fail": 1, "fals": [0, 1], "fast": 1, "featur": 0, "few": [6, 9], "figsiz": 9, "figur": 9, "file": 1, "file_idx": 1, "fine": [4, 7, 8], "first": [0, 1], "fix": 1, "float": 0, "float32": [], "follow": [0, 1, 7, 8, 9], "fontsiz": 9, "former": 0, "forward": 0, "fragment": 9, "framework": 8, "from": [1, 6, 9], "full_k": [], "full_v": [], "fulli": [], "function": [0, 9], "functool": 1, "g": [], "galleri": 4, "gamma": 4, "gamma_smc": 1, "gelu": 0, "gener": [0, 1, 9], "generate_causal_mask": 0, "generate_data": 0, "genet": 4, "get_kv": [], "git": 5, "github": [1, 5], "given": 0, "gpu": 8, "grid": 9, "h": [], "ha": 9, "hand": 9, "head": [], "head_siz": [], "help": [], "here": 1, "heurist": 9, "high": 9, "higher": 0, "home": 1, "hook": 0, "how": [1, 7, 8, 9], "http": 1, "i": [0, 1, 7, 8, 9], "idd": [7, 8], "idx": 0, "ignor": 0, "imap": 1, "implement": 9, "import": [1, 6, 9], "improv": 1, "increment": [], "index": [0, 4], "indic": 0, "infer": [1, 4, 6, 7], "inference_example_2": 9, "inference_scatter_singer_const": 1, "input": [0, 1], "instal": 4, "instanc": 0, "instead": [0, 1], "int": 0, "integ": 0, "interestingli": 9, "interpol": 0, "interpolate_tmrca": [0, 1], "interpolate_tmrca_per_window": 0, "interv": 0, "interval_end": 0, "interval_s": 0, "interval_start": 0, "involv": 1, "io": 1, "island": [1, 4, 7, 8], "island_demographi": [0, 1], "island_model": 1, "iter": 1, "itertool": 1, "j": [], "kei": [], "kevinkorfmann": 5, "kit": 1, "kkor": [1, 7, 8], "kv_cach": [], "kvcach": [], "lambda": 0, "languag": [1, 4, 9], "latter": 0, "layer": 0, "layernorm": 0, "lead": 9, "learnabl": 0, "learning_r": [0, 8], "left": 9, "length": [], "less": 9, "light": 9, "lightn": 8, "lightning_log": [], "like": 9, "line": 6, "linear": 0, "lineplot": 9, "list": [0, 1], "load": [1, 9], "load_model": 9, "loc": 9, "log": [0, 1, 9], "m": 1, "magnitu": [0, 1], "main": 1, "make": 9, "mathbf": 1, "matrix": 0, "max_batch_s": [], "max_repl": 9, "max_seq_length": [], "maximum": [], "mb": 9, "mcmc": 1, "mean": 1, "medium": 9, "memori": 0, "meta": 1, "method": 1, "migrat": [1, 9], "migration_r": 1, "mlp": 0, "mnt": 1, "mode": [], "model": [1, 4, 6, 8, 9], "model_config": [6, 9], "model_path": [6, 9], "modul": 4, "more": 1, "mse": [0, 1, 9], "msprime": 1, "much": 9, "multi": 0, "multiprocess": [0, 1], "mutation_r": 0, "mutationstolatentspac": 0, "n": 1, "n_embd": 0, "n_head": [], "n_layer": [], "nb": 1, "ndarrai": 0, "ndim": 0, "ne": [0, 1], "need": 0, "nn": 0, "non": [], "none": 0, "normal": 0, "note": 9, "now": 1, "np": [0, 1, 9], "num_epoch": 8, "num_fil": 1, "num_lay": [], "num_point": 0, "num_process": [0, 1, 7], "num_sampl": [0, 7, 9], "num_time_window": 0, "number": 0, "numpi": [1, 9], "o": 1, "object": 0, "one": 0, "onli": 1, "open": 1, "open_posterior": 1, "oper": 0, "option": 0, "order": 9, "orig": [], "origin": 0, "other": 4, "otherwis": 0, "our": 9, "out": 4, "output": [0, 1], "output_dim": [], "output_dir": 0, "over": 9, "overal": 9, "overridden": 0, "overwrit": [], "packag": [5, 9], "page": 4, "pairwis": 4, "param": 0, "paramet": 0, "parameter": 1, "parser": [], "partial": 1, "pass": 0, "per": 0, "perceptron": 0, "perform": [0, 1, 9], "period": [1, 9], "pip": 5, "pivot": 0, "pivot_a": [0, 7], "pivot_b": [0, 7], "pivot_frequ": 0, "ploidi": 0, "plot": [1, 9], "plot_inference_scatt": 1, "plt": 9, "png": [1, 9], "polar": 1, "pool": 1, "popgenmethod": 1, "popul": [1, 4, 9], "population_s": 0, "population_tim": 0, "posit": 0, "post_process": [0, 9], "pre": [], "predict": 9, "prepare_ts_data": 9, "print": 9, "probabl": 0, "process": [0, 9], "process_batch": 0, "process_fil": 1, "process_pair": 0, "project": 0, "propos": 4, "py": [7, 8], "pypi": 5, "python": [7, 8], "pytorch": [8, 9], "quick": 4, "r": [1, 5], "randn": [], "random": 0, "randomize_pivot": [0, 7], "rang": [1, 9], "read": [], "reason": 1, "recip": 0, "recombination_r": 0, "regev": 1, "regevsch": 1, "regist": 0, "regular": 0, "releas": [], "replic": [1, 9], "requir": 5, "rescu": 4, "reset": 9, "result": [0, 1], "retrieve_site_posit": 0, "return": [0, 1], "run": [0, 1, 9], "s_len": [], "sampl": [0, 1, 4], "sample_scale_embd": [], "save": 0, "save_batch": 0, "savefig": 9, "sawooth": 4, "sawtooth": [1, 7, 8, 9], "scale": 0, "scatter": 9, "scenario": [1, 7], "schweiger": 1, "sdd": [7, 8], "search": 4, "second": [0, 1], "seed": [0, 1, 6, 9], "seq_len": 0, "sequenc": [0, 1, 4, 9], "sequence_length": 0, "set": [], "set_float32_matmul_precis": 9, "sf": 0, "shape": 0, "shift": 9, "should": 0, "show": 9, "shown": [1, 9], "sietch_colab": [7, 8], "silent": 0, "simpl": 9, "simplifi": 1, "simul": [1, 4, 6, 9], "simulate_parameterized_tree_sequ": [0, 1, 6, 9], "simulate_parameterized_tree_sequence_island": 1, "simulate_parameterized_tree_sequence_sawtooth": 1, "sinc": 0, "singer": 4, "singer_mast": 1, "singular": 1, "site_posit": 0, "size": [0, 1, 9], "smc": 4, "sn": 9, "some": 1, "sourc": 0, "space": 9, "specif": [], "specifi": [], "src": 9, "src_k": [], "src_key_cach": [], "src_len": [], "src_v": [], "src_value_cach": [], "stackit": 1, "stand": 4, "start": [0, 1, 4], "start_batch": [0, 7], "step": [6, 8, 9], "step_siz": 0, "stop": 9, "store": [], "str": [0, 1], "subclass": 0, "subtitl": 1, "suffer": [], "suprisingli": [], "t": [0, 1, 6, 9], "take": 0, "target": [], "task": 9, "tensor": 0, "test": 1, "test_batch": 8, "tgt": [0, 9], "tgt_k": [], "tgt_key_cach": [], "tgt_len": [], "tgt_v": [], "tgt_value_cach": [], "than": 9, "them": [0, 1], "therebi": 4, "thi": 0, "thin": 1, "third": 1, "three": [1, 9], "tight_layout": 9, "time": [0, 9], "time_r": 0, "tini": [], "tiny_batches_base_dataset": [7, 8], "tiny_batches_sawtooth_dataset": [], "tiny_batches_ssd": 7, "titl": 9, "tmax": 0, "tmrca": [0, 1, 9], "tmrca_gamma_smc": 1, "tmrcas_comb": 1, "todo": 1, "token": [], "tokenfreedecod": 0, "tokenfreedecoderconfig": [6, 9], "tool": 4, "torch": [0, 9], "total": [0, 1], "tqdm": 1, "track": [], "train": [4, 7, 9], "transform": [], "translat": [], "translate_from_t": [6, 9], "tree": [0, 1], "treesequ": 0, "true": [0, 7], "ts2input": 0, "ts2input_numpi": 0, "ts2x_vector": 0, "ts_seed": [], "ts_seed103370001": [], "ts_seed103370001_fast": [], "ts_seed103370001_sawtooth": [], "ts_seed_": 1, "ts_seed_103370001": 1, "ts_seed_103370001_island": 1, "ts_seed_103370001_sawtooth": 1, "ts_seed_island": [], "ts_seed_sawtooth": [], "ts_simpl": 1, "ts_simulation_func": 0, "tskit": 1, "tune": [4, 7, 8], "tupl": 0, "tutori": 4, "txt": 5, "type": 0, "under": 1, "underli": 9, "understood": [], "unknown": 1, "unnessari": 9, "until": 5, "up": [], "update_sourc": [], "update_target": [], "us": [0, 1, 8, 9], "usag": 9, "use_bia": 0, "use_cach": 0, "usual": 1, "util": [1, 4, 6, 9], "v0": 1, "valid": [], "valu": 0, "variou": [1, 9], "vcf": 1, "vector": 0, "version": [], "version_8": [], "w": 1, "wa": 9, "we": 9, "weight": 0, "weight_decai": 0, "when": 9, "where": 0, "whether": 0, "which": [], "while": 0, "whose": [], "why": [], "window_s": [0, 1], "within": 0, "without": 9, "write": 1, "x": [0, 9], "xlabel": 9, "xnor": 0, "xor": 0, "xor_op": 0, "y": [0, 9], "yet": [], "yhat": [0, 6, 9], "yhats_sing": 1, "yhats_singer_log": 1, "ylabel": 9, "you": 5, "ytrue": [0, 1, 6, 9], "ytrues_log": 1, "zero": 9, "zst": 1}, "titles": ["API documentation", "Comparisons with other tools", "cxt package", "Gallery", "cxt(kit): Coalescence x Translation (toolkit)", "Installation", "Quick start", "Simulation", "Training", "Tutorial for Inference"], "titleterms": {"": [], "api": 0, "coalesc": 4, "comparison": 1, "constant": 9, "content": [2, 4], "cxt": [0, 2, 3, 4], "demo": [], "demographi": 9, "demonstr": [], "document": 0, "fine": 9, "galleri": 3, "gamma": [1, 3], "indic": 4, "infer": 9, "instal": 5, "island": 9, "kit": [3, 4], "kv_cach": [], "model": 0, "modul": [0, 2], "other": 1, "out": 9, "packag": 2, "pairwis": 9, "quick": 6, "rescu": 9, "sampl": 9, "sawooth": 9, "simul": [0, 7], "singer": [1, 3], "smc": [1, 3], "start": 6, "tabl": 4, "tool": 1, "toolkit": 4, "train": 8, "translat": 4, "tune": 9, "tutori": 9, "util": 0, "welcom": [], "x": 4}})