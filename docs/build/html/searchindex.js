Search.setIndex({"alltitles": {"API documentation": [[5, null]], "Comparisons with other tools": [[6, null]], "Constant Demography (Pairwise) Inference": [[8, "constant-demography-pairwise-inference"]], "Contents:": [[1, null]], "Gallery": [[7, null]], "Gamma-SMC": [[6, "gamma-smc"]], "Indices and tables": [[1, "indices-and-tables"]], "Installation": [[2, null]], "Module contents": [[0, "module-cxt"]], "Out-of-sample: Island Demography Inference (no fine-tuning)": [[8, "out-of-sample-island-demography-inference-no-fine-tuning"]], "Out-of-sample: Sawooth Demography Inference (no fine-tuning)": [[8, "out-of-sample-sawooth-demography-inference-no-fine-tuning"]], "Quick start": [[3, null]], "Rescue: Island Demography Inference (with fine-tuning)": [[8, "rescue-island-demography-inference-with-fine-tuning"]], "Rescue: Sawooth Demography Inference (with fine-tuning)": [[8, "rescue-sawooth-demography-inference-with-fine-tuning"]], "Simulation": [[4, null]], "Singer": [[6, "singer"]], "Singer and Gamma-SMC": [[7, "singer-and-gamma-smc"]], "Training": [[9, null]], "Tutorial for Inference": [[8, null]], "cxt package": [[0, null]], "cxt(kit)": [[7, "cxt-kit"]], "cxt(kit): Coalescence x Translation (toolkit)": [[1, null]], "cxt.model": [[5, "module-cxt.model"]], "cxt.modules": [[5, "module-cxt.modules"]], "cxt.simulations": [[5, "module-cxt.simulation"]], "cxt.utils": [[5, "module-cxt.utils"]]}, "docnames": ["cxt", "index", "installation", "quick_start", "simulation", "tmp/api", "tmp/comparison", "tmp/gallery", "tmp/tutorial", "training"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["cxt.rst", "index.rst", "installation.rst", "quick_start.rst", "simulation.rst", "tmp/api.rst", "tmp/comparison.rst", "tmp/gallery.rst", "tmp/tutorial.rst", "training.rst"], "indexentries": {}, "objects": {"": [[0, 0, 0, "-", "cxt"]], "cxt": [[5, 0, 0, "-", "model"], [5, 0, 0, "-", "modules"], [5, 0, 0, "-", "simulation"], [5, 0, 0, "-", "utils"]], "cxt.model": [[5, 1, 1, "", "TokenFreeDecoder"]], "cxt.model.TokenFreeDecoder": [[5, 2, 1, "", "cache_to_device"], [5, 2, 1, "", "clear_cache"], [5, 2, 1, "", "configure_optimizers"], [5, 2, 1, "", "forward"]], "cxt.modules": [[5, 1, 1, "", "Block"], [5, 1, 1, "", "CausalSelfAttention"], [5, 1, 1, "", "LayerNorm"], [5, 1, 1, "", "MLP"], [5, 1, 1, "", "MutationsToLatentSpace"]], "cxt.modules.Block": [[5, 2, 1, "", "forward"]], "cxt.modules.CausalSelfAttention": [[5, 2, 1, "", "forward"]], "cxt.modules.LayerNorm": [[5, 3, 1, "", "bias"], [5, 2, 1, "", "forward"], [5, 3, 1, "", "weight"]], "cxt.modules.MLP": [[5, 3, 1, "", "c_fc"], [5, 3, 1, "", "c_proj"], [5, 3, 1, "", "dropout"], [5, 2, 1, "", "forward"], [5, 3, 1, "", "gelu"]], "cxt.modules.MutationsToLatentSpace": [[5, 2, 1, "", "forward"]], "cxt.simulation": [[5, 4, 1, "", "create_sawtooth_demogaphy_object"], [5, 4, 1, "", "generate_data"], [5, 4, 1, "", "is_any_numeric_or_roman_numeral"], [5, 4, 1, "", "process_batches"], [5, 4, 1, "", "random_sample_counts"], [5, 4, 1, "", "sampling_populations"], [5, 4, 1, "", "save_batch"], [5, 4, 1, "", "simulate_random_segment"]], "cxt.utils": [[5, 1, 1, "", "DemographyStorage"], [5, 4, 1, "", "accumulating_mses"], [5, 4, 1, "", "calculate_window_sfs_vectorized"], [5, 4, 1, "", "create_sawtooth_demogaphy_object"], [5, 4, 1, "", "discretize"], [5, 4, 1, "", "diversity_bias_correction"], [5, 4, 1, "", "diversity_bias_correction_by_rep"], [5, 4, 1, "", "generate_causal_mask"], [5, 4, 1, "", "interpolate_tmrca_per_window"], [5, 4, 1, "", "interpolate_tmrcas"], [5, 4, 1, "", "mse"], [5, 4, 1, "", "population_time"], [5, 4, 1, "", "post_process"], [5, 4, 1, "", "process_pair"], [5, 4, 1, "", "retrieve_site_positions"], [5, 4, 1, "", "sample_demography"], [5, 4, 1, "", "sample_population_size"], [5, 4, 1, "", "simulate_parameterized_tree_sequence"], [5, 4, 1, "", "stochastic_diversity_bias_correction"], [5, 4, 1, "", "ts2X_vectorized"], [5, 4, 1, "", "ts2input"], [5, 4, 1, "", "ts2input_numpy"], [5, 4, 1, "", "xnor"], [5, 4, 1, "", "xor"]], "cxt.utils.DemographyStorage": [[5, 2, 1, "", "get_combinations"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "terms": {"": 6, "0": [4, 5, 6, 8, 9], "000": [], "001": 8, "06": 5, "08": 5, "09": 5, "1": [4, 5, 6, 8, 9], "10": 5, "100": 6, "1000": 4, "10000": [5, 6], "100000": 5, "1000000": [5, 6], "1001": [], "102000": [3, 8], "103370001": [6, 8], "1225": 8, "13": 8, "14": 8, "15": 6, "16": 8, "16160": [3, 8, 9], "1_000_000": 8, "1d": 5, "1e": 5, "1e6": [], "2": [5, 6, 9], "20": [5, 6, 8, 9], "200": 5, "2000": [5, 6, 8], "20000": [5, 6], "200000": 5, "200_000": 4, "2023": 6, "2024": 6, "20_000": 6, "20e3": 6, "25": [5, 6, 8], "256": [], "28e": 5, "29e": [5, 6], "2_000_000": 4, "3": 6, "30": 4, "300": 8, "3d": 5, "3e": 9, "4": [3, 5, 8, 9], "40": 5, "400": [], "4000": 5, "5": [6, 9], "50": [6, 8], "5000": 6, "500000": 5, "510000": 5, "6": [], "8": 6, "99": 6, "A": [5, 8], "And": 6, "For": 6, "If": 5, "In": [5, 8], "Or": 9, "The": [4, 5, 6, 8, 9], "To": 9, "_": 6, "_fast": 6, "_gener": 5, "_island": 6, "_sawtooth": 6, "ab": 8, "abl": 8, "acces": 6, "accordingli": 5, "accumulating_ms": [5, 8], "accuraci": 8, "accuratli": 8, "across": 5, "activ": 5, "actual": 8, "ad": 5, "add": 5, "add_argu": [], "after": [], "afterward": 5, "against": 6, "al": 6, "all": 5, "alloc": [], "alpha": [6, 8], "although": 5, "an": [5, 6], "api": [], "append": [6, 8], "appli": [], "approach": 1, "ar": [5, 6], "arg": 5, "argpars": [], "argumentpars": [], "arrai": [5, 6], "as_vcf": 6, "assum": 5, "attent": [], "attn": [], "attn_mask": 5, "attribut": 5, "autoregress": [], "avail": 2, "averag": 5, "avoid": 8, "b": [5, 6, 8], "back": 5, "base": [5, 8], "base_dataset": 4, "base_model": [3, 8, 9], "basic": 6, "batch": 5, "batch_siz": [4, 5], "becaus": 8, "becom": 8, "been": 8, "being": 8, "below": 6, "beta": [5, 6], "better": 8, "between": [6, 8], "bia": 5, "black": 8, "block": 5, "blue": 8, "bool": 5, "bottleneck": 8, "bp": 8, "break": 8, "c": 8, "c_fc": 5, "c_proj": 5, "cach": 8, "cache_k": [], "cache_to_devic": 5, "cache_v": [], "calcul": 5, "calculate_loss": 5, "calculate_window_sfs_vector": 5, "call": 5, "callabl": 5, "can": [2, 6], "captur": 8, "care": 5, "case": [5, 8], "causalselfattent": 5, "cdd": 4, "chang": [6, 8], "check": 6, "checkpoint": [3, 8, 9], "checkpoint_path": 9, "choic": [], "ckpt": [3, 8, 9], "class": 5, "clear": [], "clear_cach": 5, "clone": 2, "coalesc": 8, "code": [3, 4, 8, 9], "collaps": [], "com": [2, 6], "comb": 6, "combin": 6, "combined_dim": [], "command": [6, 9], "comparison": 8, "complex": 8, "comput": 5, "concaten": [], "config": [3, 5, 8], "configur": [5, 8], "configure_optim": 5, "consequ": 8, "constant": [4, 5, 6, 9], "contain": [5, 9], "continu": 8, "convers": 5, "convert_to_tskit": 6, "correct": 5, "count": 5, "cpu": 5, "cpu_count": 6, "create_sawtooth_demogaphy_object": [5, 6], "criteria": 8, "cuda": [], "cxt": [2, 3, 4, 6, 8, 9], "data": [4, 5, 6, 8], "data_dir": 4, "dataset": [4, 8, 9], "dataset_path": 9, "decod": [], "decreas": 8, "decreasing_ms": [], "def": 6, "default": 5, "defin": 5, "degre": 8, "demo": [], "demograph": 6, "demographi": [4, 5, 6, 9], "demographystorag": 5, "demonstr": [4, 8, 9], "deng": 6, "deriv": 8, "describ": [], "descript": [], "despit": 8, "develop": 6, "devic": 5, "device_typ": 5, "dict": 5, "dictionari": 5, "diff": 8, "differ": 6, "dimens": 5, "directori": [5, 9], "discret": 5, "distribut": [5, 8], "divers": 5, "diversity_bias_correct": 5, "diversity_bias_correction_by_rep": 5, "do": 6, "docker": 6, "document": [], "done": [5, 6], "dpi": 8, "draw": 5, "dropout": 5, "due": 8, "durbin": 6, "dure": 8, "e": 5, "each": [5, 8], "earli": 8, "easier": 8, "effici": 5, "embed": 5, "emploi": 6, "end": 6, "entropi": 8, "epoch": [3, 8, 9], "equal": 5, "estim": 5, "et": 6, "eventu": 2, "everi": 5, "exampl": [6, 8], "expans": 8, "expect": 5, "extract": 6, "f": [6, 8], "fact": 5, "fail": 6, "fals": [5, 6], "fast": 6, "featur": 5, "few": [3, 8], "figsiz": 8, "figur": 8, "file": 6, "file_idx": 6, "fine": [4, 9], "first": [5, 6], "fix": 6, "float": 5, "float32": [], "follow": [4, 5, 6, 8, 9], "fontsiz": 8, "former": 5, "forward": 5, "fragment": 8, "framework": 9, "from": [3, 5, 6, 8, 9], "full_attention_n": 5, "full_k": [], "full_v": [], "fulli": [], "function": [5, 8], "functool": 6, "g": 5, "galleri": [], "gamma": 5, "gamma_smc": 6, "gelu": 5, "gener": [5, 6, 8], "generate_causal_mask": 5, "generate_data": 5, "genet": 1, "genetic_map": 5, "genom": 5, "get_combin": 5, "get_kv": [], "git": 2, "github": [2, 6], "given": 5, "gpu": 9, "grid": 8, "h": [], "ha": 8, "hand": 8, "hard_sweep": 5, "have": 5, "head": [], "head_siz": [], "help": [], "here": 6, "heurist": 8, "high": 8, "higher": 5, "home": 6, "homsap": 5, "hook": 5, "how": [4, 6, 8, 9], "http": 6, "human": 5, "i": [4, 5, 6, 8, 9], "idd": [4, 9], "idx": 5, "ignor": 5, "ignore_target": 5, "iid": 5, "imap": 6, "implement": 8, "import": [3, 6, 8], "improp": 5, "improv": 6, "includ": 9, "increment": [], "index": [1, 5], "indic": 5, "infer": [1, 3, 4, 6], "inference_example_2": 8, "inference_scatter_singer_const": 6, "input": [5, 6], "instal": 1, "instanc": 5, "instead": [5, 6], "int": 5, "integ": 5, "interestingli": 8, "interpol": 5, "interpolate_tmrca": [5, 6], "interpolate_tmrca_per_window": 5, "interv": 5, "interval_end": 5, "interval_s": 5, "interval_start": 5, "involv": 6, "io": 6, "is_any_numeric_or_roman_numer": 5, "island": [4, 6, 9], "island_demographi": [5, 6], "island_model": 6, "item": 5, "iter": 6, "itertool": 6, "j": [], "kei": [], "kevinkorfmann": 2, "kit": 6, "kkor": [4, 6, 9], "kv_cach": [], "kvcach": [], "lambda": 5, "languag": [1, 6, 8], "latter": 5, "layer": 5, "layernorm": 5, "lead": 8, "learnabl": 5, "learning_r": [5, 9], "left": 8, "length": [], "less": 8, "light": 8, "lightn": 9, "lightning_log": [], "like": 8, "line": 3, "linear": 5, "lineplot": 8, "list": [5, 6], "llm": 9, "load": [6, 8], "load_model": 8, "loc": 8, "log": [5, 6, 8], "m": 6, "magnitu": [5, 6], "main": [6, 9], "make": 8, "map": 5, "match": 5, "mathbf": 6, "matrix": 5, "max_batch_s": [], "max_repl": 8, "max_seq_length": [], "maximum": [], "mb": 8, "mcmc": 6, "mean": 6, "medium": 8, "memori": 5, "meta": 6, "method": 6, "migrat": [6, 8], "migration_r": 6, "minimum": 5, "mlp": 5, "mnt": 6, "mode": [], "model": [1, 3, 6, 8, 9], "model_config": [3, 8], "model_path": [3, 8], "modul": [], "more": 6, "mse": [5, 6, 8], "msprime": [5, 6], "mu": 5, "much": 8, "multi": 5, "multiprocess": [5, 6], "mutat": 5, "mutation_count": 5, "mutation_r": 5, "mutation_rate_rang": 5, "mutationstolatentspac": 5, "n": [5, 6], "n_embd": 5, "n_head": [], "n_layer": [], "n_max": 5, "n_min": 5, "name": 5, "nb": 6, "ndarrai": 5, "ndim": 5, "ne": [5, 6], "need": 5, "nn": 5, "non": [], "none": 5, "nonzero": 5, "normal": 5, "note": 8, "now": 6, "np": [5, 6, 8], "num_epoch": 9, "num_fil": 6, "num_lay": [], "num_point": 5, "num_process": [4, 5, 6], "num_sampl": [4, 5, 8], "num_time_window": 5, "number": 5, "numpi": [5, 6, 8], "o": 6, "object": 5, "observ": 5, "offset": 5, "one": 5, "onli": 6, "open": 6, "open_posterior": 6, "oper": 5, "option": 5, "order": 8, "orig": [], "origin": 5, "other": [], "otherwis": 5, "our": 8, "out": [], "output": [5, 6], "output_dim": [], "output_dir": 5, "over": 8, "overal": 8, "overridden": 5, "overwrit": [], "packag": [2, 8], "page": 1, "pair": 5, "pairwis": [], "param": 5, "paramet": 5, "parameter": 6, "parser": [], "partial": 6, "pass": 5, "per": 5, "perceptron": 5, "perform": [5, 6, 8], "period": [6, 8], "pip": 2, "pivot": 5, "pivot_a": [4, 5], "pivot_b": [4, 5], "pivot_frequ": 5, "pivot_pair": 5, "ploidi": 5, "plot": [6, 8], "plot_inference_scatt": 6, "plt": 8, "png": [6, 8], "poisson": 5, "polar": 6, "pool": 6, "popgenmethod": 6, "popul": [1, 5, 6, 8, 9], "population_s": 5, "population_tim": 5, "posit": 5, "post_process": [5, 8], "posterior": 5, "pre": [], "predict": [5, 8], "prepare_ts_data": 8, "print": 8, "prior": 5, "probabl": 5, "process": [5, 8], "process_batch": 5, "process_fil": 6, "process_pair": 5, "project": 5, "propos": 1, "py": [4, 9], "pypi": 2, "python": [4, 9], "pytorch": [8, 9], "quick": 1, "r": [2, 6], "randn": [], "random": 5, "random_sample_count": 5, "random_scenario": 5, "randomize_pivot": [4, 5], "randomli": 5, "rang": [6, 8, 9], "rate": 5, "read": [], "reason": 6, "recip": 5, "recombination_r": 5, "recombination_rate_rang": 5, "regev": 6, "regevsch": 6, "regist": 5, "regular": 5, "releas": [], "replic": [5, 6, 8], "reproduc": 5, "requir": 2, "rescu": [], "reset": 8, "result": [5, 6], "retrieve_site_posit": 5, "return": [5, 6], "return_intercept": 5, "rng": 5, "run": [5, 6, 8], "s_len": [], "sampl": [5, 6], "sample_demographi": 5, "sample_population_s": 5, "sample_scale_embd": [], "sampling_popul": 5, "save": 5, "save_batch": 5, "savefig": 8, "sawooth": [], "sawtooth": [4, 6, 8, 9], "scale": 5, "scatter": 8, "scenario": [4, 6, 9], "schweiger": 6, "sdd": [4, 9], "search": 1, "second": [5, 6], "seed": [3, 5, 6, 8], "segment": 5, "segment_length": 5, "selection_coeffici": 5, "selection_posit": 5, "seq_len": 5, "sequenc": [1, 5, 6, 8], "sequence_length": 5, "set": [], "set_float32_matmul_precis": 8, "sf": 5, "shape": 5, "shift": 8, "should": 5, "show": 8, "shown": [6, 8], "sietch_colab": [4, 9], "silent": 5, "simpl": 8, "simplifi": 6, "simul": [1, 3, 6, 8], "simulate_parameterized_tree_sequ": [3, 5, 6, 8], "simulate_parameterized_tree_sequence_island": 6, "simulate_parameterized_tree_sequence_sawtooth": 6, "simulate_random_seg": 5, "sinc": 5, "singer": [], "singer_mast": 6, "singular": 6, "site_posit": 5, "size": [5, 6, 8, 9], "smc": [], "sn": 8, "some": 6, "sourc": 5, "space": 8, "species_nam": 5, "specif": [], "specifi": [], "src": 8, "src_k": [], "src_key_cach": [], "src_len": [], "src_v": [], "src_value_cach": [], "ssd": 4, "stackit": 6, "stand": 1, "start": [1, 5, 6], "start_batch": [4, 5], "stdpopsim": 5, "step": [3, 8, 9], "step_siz": 5, "stochast": 5, "stochastic_diversity_bias_correct": 5, "stop": 8, "store": [], "str": [5, 6], "subclass": 5, "subdirectori": 9, "subtitl": 6, "suffer": [], "sum_i": 5, "suprisingli": [], "sweep": 9, "t": [3, 5, 6, 8], "take": 5, "target": [], "task": 8, "tensor": 5, "test": 6, "test_batch": 9, "tgt": [5, 8], "tgt_k": [], "tgt_key_cach": [], "tgt_len": [], "tgt_v": [], "tgt_value_cach": [], "than": 8, "them": [5, 6], "therebi": 1, "thi": 5, "thin": 6, "third": 6, "three": [6, 8], "tight_layout": 8, "time": [5, 8], "time_r": 5, "tini": [], "tiny_batches_base_dataset": 9, "tiny_batches_sawtooth_dataset": [], "tiny_batches_ssd": [], "titl": 8, "tmax": 5, "tmrca": [5, 6, 8], "tmrca_gamma_smc": 6, "tmrca_i": 5, "tmrcas_comb": 6, "todo": 6, "token": [], "tokenfreedecod": 5, "tokenfreedecoderconfig": [3, 8], "tool": [], "torch": [5, 8], "total": [5, 6], "tqdm": 6, "track": [], "train": [1, 4, 8], "transform": [], "translat": [], "translate_from_t": [3, 8], "tree": [5, 6], "tree_sequ": 5, "treesequ": 5, "true": [4, 5], "ts2input": 5, "ts2input_numpi": 5, "ts2x_vector": 5, "ts_seed": [], "ts_seed103370001": [], "ts_seed103370001_fast": [], "ts_seed103370001_sawtooth": [], "ts_seed_": 6, "ts_seed_103370001": 6, "ts_seed_103370001_island": 6, "ts_seed_103370001_sawtooth": 6, "ts_seed_island": [], "ts_seed_sawtooth": [], "ts_simpl": 6, "ts_simulation_func": 5, "tskit": [5, 6], "tune": [4, 9], "tupl": 5, "tutori": [], "txt": 2, "type": 5, "undefin": 5, "under": [5, 6], "underli": 8, "understood": [], "unknown": 6, "unnessari": 8, "until": 2, "up": [], "update_sourc": [], "update_target": [], "us": [5, 6, 8, 9], "usag": 8, "use_bia": 5, "use_cach": 5, "usual": 6, "util": [3, 6, 8], "v0": 6, "valid": [], "valu": 5, "variabl": 9, "variou": [6, 8, 9], "vcf": 6, "vector": 5, "version": [], "version_8": [], "w": 6, "wa": 8, "we": 8, "weight": 5, "weight_decai": 5, "when": 8, "where": 5, "whether": 5, "which": [], "while": 5, "whose": [], "why": [], "window": 5, "window_s": [5, 6], "window_size_i": 5, "within": 5, "without": 8, "write": 6, "x": [5, 8], "xlabel": 8, "xnor": 5, "xor": 5, "xor_op": 5, "y": [5, 8], "yet": [], "yhat": [3, 5, 8], "yhats_sing": 6, "yhats_singer_log": 6, "ylabel": 8, "you": 2, "ytrue": [3, 5, 6, 8], "ytrues_log": 6, "zero": [5, 8], "zero_offset": 5, "zst": 6}, "titles": ["cxt package", "cxt(kit): Coalescence x Translation (toolkit)", "Installation", "Quick start", "Simulation", "API documentation", "Comparisons with other tools", "Gallery", "Tutorial for Inference", "Training"], "titleterms": {"": [], "api": 5, "coalesc": 1, "comparison": 6, "constant": 8, "content": [0, 1], "cxt": [0, 1, 5, 7], "demo": [], "demographi": 8, "demonstr": [], "document": 5, "fine": 8, "galleri": 7, "gamma": [6, 7], "indic": 1, "infer": 8, "instal": 2, "island": 8, "kit": [1, 7], "kv_cach": [], "model": 5, "modul": [0, 5], "other": 6, "out": 8, "packag": 0, "pairwis": 8, "quick": 3, "rescu": 8, "sampl": 8, "sawooth": 8, "simul": [4, 5], "singer": [6, 7], "smc": [6, 7], "start": 3, "tabl": 1, "tool": 6, "toolkit": 1, "train": 9, "translat": 1, "tune": 8, "tutori": 8, "util": 5, "welcom": [], "x": 1}})